# Scenario: OS Credential Dumping Detection (T1003.001)

## What is T1003.001?
Attackers try to steal passwords and authentication credentials by accessing the LSASS (Local Security Authority) process in Windows memory. This gives them credentials to move around the network.

## What We Did
We used Atomic Red Team to simulate a credential dumping attack, then detected it using Splunk.

## How We Detected It
We monitored Sysmon Event ID 10 (Process Access) for:
- Attempts to read LSASS.exe memory
- Suspicious processes accessing LSASS (like procdump.exe)
- Specific access rights used for credential theft (0x1010, 0x1410)

---

## Attack Simulation
> <img width="1030" height="710" alt="image" src="https://github.com/user-attachments/assets/b65d3342-59f5-4003-86fd-6b1697f654da" />


> *Screenshot of the command used*

---

## Detection Results
- Successfully detected unauthorized access to LSASS.exe
- Identified the source process attempting the attack
- Alert triggered immediately with critical severity
 
> <img width="1025" height="666" alt="image" src="https://github.com/user-attachments/assets/75fb74d6-a8c6-4670-a82a-c3ea6c3cde96" />


*SPL Query*
```SPL Query
index="endpoint" host=windows-10 source=Sysmon EventID=10 TargetImage="*lsass.exe"
| search GrantedAccess IN ("0x1010", "0x1410", "0x1fffff", "0x143a", "0x1438")
| stats count as lsass_access_count, values(SourceImage) as accessing_process, values(GrantedAccess) as access_rights by User, ComputerName, _time
| eval severity="critical", technique="T1003.001", kill_chain="Credential Access", threat="CREDENTIAL THEFT"
| where lsass_access_count >= 1
```

> <img width="1020" height="222" alt="image" src="https://github.com/user-attachments/assets/50b04b7e-58c0-4dec-9adb-1d9bcaa9b9e5" />


> <img width="643" height="562" alt="image" src="https://github.com/user-attachments/assets/f1170392-34e2-4747-bbcc-2308e65233d4" />


*Add an Alert Example*
[here]
