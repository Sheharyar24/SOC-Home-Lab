# Scenario: PowerShell Execution (T1059.001)

## What is T1059.001?
Attackers use PowerShell to run malicious commands and scripts. PowerShell is powerful and often trusted, making it a common target for attacks.

## What We Did
We used Atomic Red Team to simulate a PowerShell attack, then detected it using Splunk.

## How We Detected It
- We monitored Sysmon Event ID 1 (Process Creation) for:
- PowerShell.exe being launched
- Unusual parent processes launching PowerShell
- Obfuscated or encoded commands

---

## Attack Simulation
> <img width="628" height="147" alt="image" src="https://github.com/user-attachments/assets/aaf761e9-0c2b-4bdb-93c5-29ca8c877e6e" />

> *Screenshot of the command used*

---

## Detection Results
- Successfully detected PowerShell execution with suspicious characteristics
- Alert triggered when unusual parent process spawned PowerShell
- Encoded command strings identified and decoded
 
> <img width="1030" height="734" alt="image" src="https://github.com/user-attachments/assets/971c8446-0dd1-435d-a4b6-b9a152977315" />

*SPL Query*
```SPL Query
Index="endpoint" source="Sysmon" EventID=1 Image="*powershell.exe"
| search CommandLine IN ("*ExecutionPolicy Bypass*", "*EncodedCommand*", "*WindowStyle Hidden*", "*-NoProfile*")
| stats count as execution_count, values(CommandLine) as commands by user, _time
| eval severity="medium", technique="T1059.001", kill_chain="Execution"
```

> <img width="1252" height="623" alt="image" src="https://github.com/user-attachments/assets/c531c971-cfac-4ea1-9387-079b17ead89b" />

> <img width="640" height="565" alt="image" src="https://github.com/user-attachments/assets/b370d770-1dc1-419f-96f8-ad482488d9a7" />

*Add an Alert Example*
[here]
