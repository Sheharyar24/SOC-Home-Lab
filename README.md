# SOC Home Lab – Splunk SIEM & Attack Simulation

## Objective
The SOC Detection Lab project establishes a controlled, enterprise-style environment to **simulate cyber attacks, generate telemetry, and detect malicious activity using Splunk SIEM**. 

The lab ingests logs from Windows and Linux endpoints, correlates events generated by adversary emulation (Kali Linux) and Atomic Red Team, and produces detections aligned to **MITRE ATT&CK**. The goal is to demonstrate practical SOC, blue team, and detection engineering skills through hands-on implementation.

---

### Skills & Technologies
| Category | Skills Demonstrated |
| :--- | :--- |
| **SIEM Administration** | Splunk Enterprise deployment, Forwarder configuration, Index management |
| **Log Analysis** | Sysmon, Windows Event Logs, Linux Auth/Audit logs, Normalization |
| **Adversary Emulation** | Atomic Red Team (ART), Hydra, Nmap, MITRE ATT&CK mapping |
| **Detection Engineering** | Writing SPL (Search Processing Language) queries, creating alerts |
| **Infrastructure** | Virtualization (VMware/VirtualBox), Networking, Ubuntu/Windows OS hardening |

---

### Lab Architecture
**Network Segment:** `192.168.10.x` (NAT Network)

* **Splunk SIEM (Ubuntu):** `192.168.10.15` - Central Log Server
* **Target 1 (Windows 10):** `192.168.10.4` - Running Sysmon & Universal Forwarder
* **Target 2 (Ubuntu):** `192.168.10.5` - Running Auditd & Universal Forwarder
* **Attacker (Kali Linux):** `192.168.10.7` - Attack Tools

*Ref 1: SOC Home Lab Architecture Diagram*
> <img width="550" height="550" alt="image" src="https://github.com/user-attachments/assets/22b03a39-6834-4fac-8e1e-bb0b109c34d1" />

---

## Attack Scenarios & Detection

To demonstrate a full range of detection capabilities, I simulated a multi-stage attack lifecycle involving Reconnaissance, Credential Dumping, and Ransomware behavior.

### Attack Scenarios: Windows Endpoint
**Objective:** Execute high-fidelity attack patterns to test Splunk correlation rules.

| MITRE ID | Technique Name | Command Used | Why This Matters? |
| :--- | :--- | :--- | :--- |
| **T1059.001** | **PowerShell Execution** | `Invoke-AtomicTest T1059.001` | **Initial Access:** Simulates malicious scripts often used by droppers/downloaders. |
| **T1003.001** | **OS Credential Dumping (LSASS)** | `Invoke-AtomicTest T1003.001` | **Credential Access:** Simulates tools like **Mimikatz** trying to steal admin passwords. (Critical Alert) |
| **T1490** | **Inhibit System Recovery** | `Invoke-AtomicTest T1490` | **Impact:** Deletes Shadow Copies (Volume Shadow Copy Service). This is a classic **Ransomware** precursor. |

---

### Scenario 1: PowerShell Execution (T1059.001)
* **Attack:** Executed **T1059.001** using Atomic Red Team to simulate malicious PowerShell script execution
* **Detection:** Utilized Splunk to monitor Sysmon Event ID 1 (Process Creation) for PowerShell instances
* **Result:** Created a Splunk Alert that triggers when PowerShell is spawned by an unusual parent process or contains obfuscated command strings.

*Ref 2: Splunk Detection of T1059.001*
> <img width="1030" height="734" alt="image" src="https://github.com/user-attachments/assets/7c0c50d6-f1e8-4aa2-a070-8b98ca835c86" />
> <img width="1252" height="623" alt="image" src="https://github.com/user-attachments/assets/f8b8cb28-63dd-469f-829f-869a9e6c5195" />
[See more in this file](https://github.com/Sheharyar24/SOC-Home-Lab/blob/main/Scenarios/T1059.001_PowerShell_Execution.md)


---

### Scenario 2: OS Credential Dumping (T1003.001)
* **Attack:** Executed Atomic Red Team test **T1003.001** to simulate credential dumping attack using Mimikatz-like techniques
* **Detection:** Configured Splunk to alert on Sysmon Event ID 10 (Process Access) where the TargetImage is lsass.exe and the GrantedAccess includes specific rights (e.g., 0x1010 or 0x1410) required to read memory.
* **Result:** Successfully triggered a high-severity alert identifying the source process (e.g., procdump.exe or a suspicious PowerShell script) attempting to harvest credentials.

*Ref 3: Splunk Detection of T1003.001*
> <img width="1025" height="666" alt="image" src="https://github.com/user-attachments/assets/c0d6c6da-9cf0-4d56-9cc9-1e13d71d1f39" />
> <img width="1020" height="222" alt="image" src="https://github.com/user-attachments/assets/13880082-3485-4345-99ab-5e7d69ee5eaf" />



---

### Scenario 3: Inhibit System Recovery (T1490)
* **Attack:** Executed Atomic Red Team test **T1490** to simulate ransomware attack preparation
* **Detection:** Monitored Sysmon Event ID 1 and Windows Security Event ID 4688 for command-line arguments containing delete shadows or resize shadowstorage.
* **Result:** Created a critical alert to detect "Pre-Ransomware Activity." This provides a vital early warning before data encryption begins.

*Ref 4: Splunk Detection of T1490*
> [Screenshot of Splunk Search Result]

---

## Roadmap & Improvements
This project is a **living SOC environment**. Future integrations will include:
* [ ] **Firewall Integration:** pfSense for network traffic visibility.
* [ ] **Threat Intel:** Integration of OTX Pulse or other IOC feeds.
* [ ] **EDR/XDR:** Testing OpenEDR or Wazuh agents.
* [ ] **SOAR:** Automating response actions (e.g., blocking IPs).

---

## ⚠️ Disclaimer
All attack activity is conducted in a **strictly controlled and isolated lab environment** for educational purposes.
